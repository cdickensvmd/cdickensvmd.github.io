<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veterinary Bloodwork</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #e6f7ff;
        }
        .section {
            margin-bottom: 30px;
        }
        .section h2 {
            margin-bottom: 10px;
        }
        .test-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            cursor: grab;
            justify-content: space-between;
            padding: 5px;
            border: 1px solid #ccc;
            background-color: #fff;
            border-radius: 5px;
        }
        .test-row.dragging {
            opacity: 0.5;
        }
        .test-row label {
            flex: 2;
            text-align: right;
            margin-right: 10px;
        }
        .test-row input {
            flex: 3;
            padding: 5px;
            width: 100%;
            box-sizing: border-box;
        }
        .test-row span {
            flex: 1;
            margin-left: 10px;
            text-align: center;
        }
        .drag-handle {
            cursor: grab;
            margin-right: 10px;
        }
        #output {
            margin-top: 20px;
            padding: 10px;
            border: 2px solid #000;
            background-color: lightblue;
            white-space: pre-wrap;
        }
        .add-test {
            margin-top: 10px;
            display: flex;
            align-items: center;
        }
        .add-test input {
            margin-right: 5px;
            padding: 5px;
        }
        .delete-button {
            margin-left: 10px;
            cursor: pointer;
            color: red;
            font-weight: bold;
	    font-size: 14px;
            }
    </style>
</head>
<body>

    <h1>Veterinary Bloodwork Entry</h1>

    <div class="section" id="CBC">
    <h2>CBC</h2>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">WBC</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">x10^3/µL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Neutrophils</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">x10^3/µL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Lymphocytes</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">x10^3/µL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Eosinophils</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">x10^3/µL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Monocytes</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">x10^3/µL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Basophils</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">x10^3/µL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">RBC</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">x10^6/µL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">HGB</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">g/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">HCT</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">%</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">MCV</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">fL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">MCHC</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">g/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Platelets</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">x10^3/µL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Platelet Estimate</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">HPF</span>
    </div>
   <button onclick="addTest('CBC')">Add Additional CBC Test</button>
</div>

<div class="section" id="chemistry">
    <h2>Chemistry</h2>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">BUN</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Creatinine</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">BUN/Creatinine Ratio</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Phosphorus</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Calcium</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Corrected Calcium</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Total Protein (TP)</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">g/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Albumin</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">g/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Globulin</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">g/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Albumin/Globulin Ratio</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Glucose</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Cholesterol</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">ALT</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">U/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">ALP</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">U/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">GGT</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">U/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Total Bilirubin</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Sodium</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mEq/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Potassium</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mEq/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Chloride</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mEq/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Magnesium</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Na/K Ratio</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Est Osm</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mOsm/kg</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">CPK</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">U/L</span>
    </div>
    <button onclick="addTest('chemistry')">Add Additional Chemistry Test</button>
</div>

<div class="section" id="vbg">
    <h2>PCV/TS/VBG</h2>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">PCV</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">%</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">TS</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">g/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">BG</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">pO2</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmHg</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">pCO2</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmHg</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">HCO3</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmol/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">TCO2</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmol/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">pH</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">BE</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmol/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Sodium</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmol/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Potassium</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmol/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Chloride</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmol/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Ionized Calcium</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmol/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Anion Gap</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmol/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Lactate</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmol/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">BUN</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Creatinine</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Glucose</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <button onclick="addTest('vbg')">Add Additional VBG Test</button>
</div>

<div class="section" id="other-tests">
    <h2>Other Tests</h2>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">PCV</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">%</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">TS</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">g/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">BG</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Ketones</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">mmol/L</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Abdominocentesis</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
     <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Thoracocentesis</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
     <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">IH cytology</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <button onclick="addTest('other-tests')">Add Additional Test</button>
</div>

<div class="section" id="urinalysis">
    <h2>Urinalysis</h2>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Collection Method</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Color</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Appearance</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">SPG</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">pH</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Protein</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Glucose</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Ketones</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Bilirubin</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">WBC</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">HPF</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">RBC</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">HPF</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Casts</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">LPF</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Crystals</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">HPF</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Bacteria</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">HPF</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Epithelial Cells</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">HPF</span>
    </div>
    <button onclick="addTest('urinalysis')">Add Additional Urinalysis Test</button>
</div>

<div class="section" id="endocrine">
    <h2>Endocrine</h2>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">T4</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">µg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Free T4</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">ng/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">TSH</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">µIU/mL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">ACTH Stim</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">µg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Baseline Cortisol</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">µg/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Cortisol</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">µg/dL</span>
    </div>
    <button onclick="addTest('endocrine')">Add Additional Endocrine Test</button>
</div>

<div class="section" id="coagulation">
    <h2>Coagulation</h2>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">PT</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">sec</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">PTT</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">sec</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">D-Dimer</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">ng/mL</span>
    </div>
    <button onclick="addTest('coagulation')">Add Additional Coagulation Test</button>
</div>

<div class="section" id="Fluid Analysis">
    <h2>Fluid Analysis</h2>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Color</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Clarity</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">SPG</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit"></span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">Protein</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">gm/dL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">WBC</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">uL</span>
    </div>
    <div class="test-row" draggable="true">
        <span class="drag-handle">☰</span>
        <label class="test-name">RBC</label>
        <input type="text" class="test-value" oninput="updateOutput()" />
        <span class="test-unit">uL</span>
    </div>
    <button onclick="addTest('Fluid Analysis')">Add Additional Test</button>
</div>

<h2>Bloodwork Results:</h2>
<div class="section" id="output">
    <pre id="output-content">Bloodwork Values (Results):</pre>
</div>
<button onclick="copyToClipboard()">Copy Results</button>

<label>
    <input type="checkbox" id="include-units" checked onchange="updateOutput()"> Include Units in Results
</label>

<style>
    /* Style to ensure the output content is at the top of the section */
    #output {
        display: flex;
        flex-direction: column;
        justify-content: top flex-start; /* Align content at the top */
        border: 3px solid #000000; /* Optional: Add border for clarity */
        padding: 10px;
        margin-top: 20px;
        max-height: 900px; /* Optional: Set max height to handle large content */
        overflow-y: auto; /* Optional: Add scroll for overflow */
    }

    #output-content {
        white-space: pre-wrap; /* Preserve whitespace while wrapping text */
        font-family: monospace; /* Use monospace font for better readability */
    }
</style>

<script>
   function updateOutput() {
    const includeUnits = document.getElementById('include-units').checked;
    const sections = ['CBC', 'chemistry', 'vbg', 'other-tests', 'urinalysis', 'endocrine', 'coagulation', 'Fluid Analysis'];
    const output = document.getElementById('output-content');
    let results = 'Bloodwork Values (Results):\n';

    sections.forEach(sectionId => {
        const section = document.getElementById(sectionId);
        if (!section) return;

        const rows = section.querySelectorAll('.test-row');
        let sectionResults = '';

        rows.forEach(row => {
            const testNameFull = row.querySelector('.test-name').innerText.trim();
            const testKey = testNameFull.charAt(0).toUpperCase() + testNameFull.slice(1).toLowerCase(); // Capitalize first letter
            const testName = testAbbreviations[testKey] || testNameFull;
            const value = row.querySelector('.test-value').value;
            const unitElement = row.querySelector('.test-unit');
            const unit = unitElement ? unitElement.innerText : '';

	    // Include only rows with a value
            if (value) {
                sectionResults += `${testName} ${value}`;
                if (includeUnits && unit) {
                    sectionResults += ` ${unit}`;
                }
                sectionResults += `, `;
            }
        });
        // Add section results if there are any
        if (sectionResults.trim()) {
            const sectionTitle = section.querySelector('h2') 
                ? section.querySelector('h2').innerText 
                : sectionId;
            results += `${sectionTitle}:\n${sectionResults.trim()}\n\n`;
        }
    });

    output.textContent = results.trim();
}

    const testAbbreviations = {
    'Wbc': 'WBC',
    'Rbc': 'RBC',
    'Hemoglobin': 'HGB',
    'Hematocrit': 'HCT',
    'Platelets': 'Plt',
    'Mean Corpuscular Volume': 'MCV',
    'Mean Corpuscular Hemoglobin': 'MCH',
    'Mean Corpuscular Hemoglobin Concentration': 'MCHC',
    'Red Cell Distribution Width': 'RDW',
    'Neutrophils': 'Neu',
    'Lymphocytes': 'LYM',
    'Monocytes': 'MONO',
    'Eosinophils': 'EOS',
    'Basophils': 'BASO',
    'Glucose': 'GLU',
    'Calcium': 'Ca',
    'Sodium': 'Na',
    'Potassium': 'K',
    'Phosphorus': 'PHOS',
    'Chloride': 'CL',
    'Bicarbonate': 'HCO3',
    'Blood Urea Nitrogen': 'BUN',
    'Creatinine': 'CRE',
    'Alanine Aminotransferase': 'ALT',
    'Aspartate Aminotransferase': 'AST',
    'Alkaline Phosphatase': 'ALP',
    'Total Bilirubin': 'Tbil',
    'Albumin': 'ALB',
    'Total Protein (TP)': 'TP',
    'Anion Gap': 'AG',
    'Cholesterol': 'Chol',
    'Magnesium': 'Mg',
    'Ionized Calcium': 'iCa',
};


    function copyToClipboard() {
        const output = document.getElementById('output-content');
        navigator.clipboard.writeText(output.textContent).then(() => {
            alert('Results copied to clipboard!');
        }).catch(err => {
            alert('Failed to copy to clipboard: ' + err);
        });
    }

    function addTest(sectionId) {
        const section = document.getElementById(sectionId);
        const testName = prompt('Enter the test name (e.g., TP):');
        const unit = prompt('Enter the unit of measurement (e.g., g/dL):');  // This can be left blank

        if (testName) {
            const newRow = document.createElement('div');
            newRow.className = 'test-row';
            newRow.draggable = true;

            newRow.innerHTML = `
                <span class="drag-handle">☰</span>
                <label class="test-name">${testName}</label>
                <input type="text" class="test-value" oninput="updateOutput()" />
                ${unit ? `<span class="test-unit">${unit}</span>` : ''}
                <span class="delete-button" onclick="deleteTest(this)">x</span>
            `;

            addDragAndDropHandlers(newRow);

            const button = document.getElementById('enter-new-test'); // Assuming the button has this ID
            section.insertBefore(newRow, button);
        }
    }

    function deleteTest(deleteButton) {
        const testRow = deleteButton.parentElement;
        testRow.remove();
        updateOutput();
    }

    function addDragAndDropHandlers(row) {
        row.addEventListener('dragstart', function () {
            draggedElement = row;
            row.classList.add('dragging');
        });

        row.addEventListener('dragend', function () {
            draggedElement = null;
            row.classList.remove('dragging');
        });

        row.addEventListener('dragover', function (e) {
            e.preventDefault();
            const currentElement = e.target.closest('.test-row');
            if (currentElement && currentElement !== draggedElement) {
                const rect = currentElement.getBoundingClientRect();
                const next = (e.clientY - rect.top) > (rect.height / 2);
                currentElement.parentNode.insertBefore(draggedElement, next ? currentElement.nextSibling : currentElement);
            }
        });
    }

    document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('.test-row').forEach(addDragAndDropHandlers);
    });
</script>

<footer>
    <p>&copy;2024 Bloodwork Value Entry Tool. Created by Cody Dickens, VMD. All rights reserved.</p>
    <p><a href="/license">License</a></p> <!-- Link to License Page -->
</footer>

